#pragma once

#include <string_view>

namespace cclone::build_info {

    inline constexpr std::string_view git_branch{"@CCLONE_GIT_BRANCH@"};
    inline constexpr std::string_view git_commit{"@CCLONE_GIT_COMMIT@"};
    inline constexpr std::string_view git_commit_short{"@CCLONE_GIT_COMMIT_SHORT@"};
    inline constexpr std::string_view git_tag{"@CCLONE_GIT_TAG@"};
    inline constexpr std::string_view git_dirty_token{"@CCLONE_GIT_DIRTY@"};
    inline constexpr bool git_dirty = git_dirty_token == "true";
    inline constexpr std::string_view build_timestamp_utc{"@CCLONE_BUILD_TIMESTAMP@"};

    struct GitInfo {
    std::string_view branch;
    std::string_view commit;
    std::string_view commit_short;
    std::string_view tag;
    bool dirty;
    std::string_view timestamp;
};

constexpr GitInfo get_git_info() {
    return {
        cclone::build_info::git_branch,
        cclone::build_info::git_commit,
        cclone::build_info::git_commit_short,
        cclone::build_info::git_tag,
        cclone::build_info::git_dirty,
        cclone::build_info::build_timestamp_utc
    };
}

// Использование:
constexpr auto git = get_git_info();  // ✅ Теперь работает!
} // namespace cclone::build_info
